(()=>{"use strict";console.log("JS  loaded!");const t=document.querySelector(".cart-products"),e=document.querySelector(".total-cost_b"),s=document.querySelectorAll(".part"),n=document.querySelectorAll(".step"),a=document.getElementById("buttons-control"),c=a.querySelector(".btn-outline"),r=a.querySelector(".btn-primary"),o={step:0,cartItems:[{id:1,name:"破壞補丁修身牛仔褲",image:"src/img/product_one.png",amount:1,price:3999,subtotal:""},{id:2,name:"刷色直筒牛仔褲",image:"src/img/product_two.png",amount:1,price:1299,subtotal:""}],calcSubtotal(t){t.subtotal=t.amount*t.price},changeAmount(t,e){const s=this.cartItems.find((e=>e.id===Number(t)));"plus"===e?s.amount++:"minus"===e&&s.amount>0&&s.amount--,this.calcSubtotal(s)},cartTotal(){return this.cartItems.reduce(((t,e)=>t+e.subtotal),0)}},i={renderCartList(){let e="";o.cartItems.forEach((t=>{o.calcSubtotal(t),e+=`\n        <div class="c-product-card w-100 mb-4 d-flex">\n          <div class="c-product-img">\n            <img src="${t.image}" alt="">\n          </div>\n          <div class="c-product-info d-grid justify-content-end align-items-center">\n            <p class="c-product-name">${t.name}</p>              \n            <div class="c-product-qty d-flex align-items-center" data-id="${t.id}">\n              <button class="btn btn-minus"><i class="fas fa-minus"></i></button>\n              <span class="c-product-qty_amount"> ${t.amount}</span>\n              <button class="btn btn-plus"><i class="fas fa-plus"></i></button>\n            </div>\n            <b class="c-product-price price"> $${t.subtotal.toLocaleString("en-US")}</b>\n          </div>\n        </div>\n      `})),t.innerHTML=e},renderCartTotal(){e.innerText=`$${o.cartTotal().toLocaleString("en-US")}`},renderFormPart(t,e){s[t].classList.toggle("d-none"),s[e].classList.toggle("d-none")},setStepperStatus(t,e){const s=n[t];if("next"===e){const e=n[t+1];s.classList.remove("active"),s.classList.add("checked"),e.classList.add("active")}else{const e=n[t-1];s.classList.remove("active"),e.classList.remove("checked"),e.classList.add("active")}},setBtnStatus(){0===o.step?c.classList.add("d-none"):c.classList.remove("d-none"),o.step===s.length-1?r.innerHTML="確認下單":r.innerHTML='下一步<img src="./src/img/arrow-right.png" class="ml-3"></button>'}},l={setSite(){i.renderCartList(),i.renderCartTotal()},changeStep(t){t.target===r&&"下一步"===t.target.innerText?(i.setStepperStatus(o.step,"next"),i.renderFormPart(o.step,o.step+1),o.step++):t.target===c.firstElementChild&&(i.setStepperStatus(o.step,"prev"),i.renderFormPart(o.step,o.step-1),o.step--),i.setBtnStatus()},changeCartAmount(t,e){o.changeAmount(t,e),i.renderCartList(),i.renderCartTotal()}};t.addEventListener("click",(t=>{const e=t.target.closest(".btn"),s=e.parentElement.dataset.id;e.matches(".btn-plus")&&l.changeCartAmount(s,"plus"),e.matches(".btn-minus")&&l.changeCartAmount(s,"minus")})),a.addEventListener("click",(t=>{t.preventDefault(),l.changeStep(t)})),l.setSite()})();